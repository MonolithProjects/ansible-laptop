---
- name: Install Software
  hosts: laptop
  become: yes
  gather_facts: yes
  tasks:

  - name: Install pip
    import_role:
      name: geerlingguy.pip

  # - name: Update all pip packages (for pip >= 2.33)
  #   shell: |
  #     set -o pipefail
  #     pip --disable-pip-version-check list --outdated --format=json | python -c "import json, sys; print('\n'.join([x['name'] for x in json.load(sys.stdin)]))"| xargs -n1 pip install -U
  #   args:
  #     executable: /bin/bash
  #   changed_when: false


  - name: Uninstall DNF Packages
    package:
      name: "{{ dnf_packages_absent }}"
      state: absent

  - name: Install DNF Packages
    package:
      name: "{{ dnf_packages }}"
      state: present

  - name: Install Snap Packages
    snap:
      name: "{{ snap_packages }}"

  - name: Install Snap Packages (Classic)
    snap:
      name: "{{ snap_packages_classic }}"
      classic: yes

  - name: Upgrade pip
    pip:
      name: pip
      extra_args: --upgrade

  - name: Install user pip packages
    pip:
      name: "{{ pip_packages }}"
      extra_args: --user --upgrade
    become: no

  - name: Install global pip packages
    pip:
      name: "{{ global_pip_packages }}"
      extra_args: --upgrade

  - name: Install and upgrade brew formulaes
    import_role:
      name: monolithprojects.homebrew

  - name: Install Kubeseal client
    import_role:
      name: andrewrothstein.kubeseal

  - name: Install k9s
    import_role:
      name: andrewrothstein.k9s

  - name: ArgoCD CLI
    import_role:
      name: andrewrothstein.argocd
